# =============================================================================
# GitLab CI/CD Variables — Example / Template
# =============================================================================
# This file documents every variable the pipeline understands.
# DO NOT commit real credentials here — set them in GitLab instead:
#   Settings → CI/CD → Variables
# =============================================================================

# -----------------------------------------------------------------------------
# Pipeline behaviour variables
# These can be set as project defaults OR overridden per-run via
# "Run pipeline → Variables" in the GitLab UI.
# -----------------------------------------------------------------------------

RUN_TESTS:
  description: >
    Set to "false" to skip the test suite and only compile the binary.
    The scan-and-store job still runs; this only shortens the build stage.
    Use for quick scans when time is limited.
  value: "true"        # default — run tests on every build
  masked: false
  protected: false

SYNC_NETBOX:
  description: >
    Set to "true" to push the freshly scanned inventory into NetBox after
    the scan completes. Requires NETBOX_URL and NETBOX_TOKEN to be set.
    When "false" (default) only the in-repo inventory files are updated.
  value: "false"
  masked: false
  protected: false

INVENTORY_DIR:
  description: >
    Sub-folder inside this repository where the Markdown and JSON inventory
    reports are committed by the scan-and-store job.
    Changing this does NOT move existing files; create a migration commit
    manually if you rename it.
  value: "inventory"
  masked: false
  protected: false

# -----------------------------------------------------------------------------
# iDRAC credentials
# Mark these as Masked (and Protected for production) in the GitLab UI.
# -----------------------------------------------------------------------------

IDRAC_DEFAULT_USER:
  description: "Default username for iDRAC authentication"
  value: "root"
  masked: true
  protected: false

IDRAC_DEFAULT_PASS:
  description: "Default password for iDRAC authentication"
  value: "REPLACE_WITH_YOUR_PASSWORD"
  masked: true
  protected: true

# -----------------------------------------------------------------------------
# NetBox integration (only required when SYNC_NETBOX=true)
# -----------------------------------------------------------------------------

NETBOX_URL:
  description: "NetBox API base URL, e.g. https://netbox.example.com"
  value: "https://netbox.yourdomain.com"
  masked: false
  protected: false

NETBOX_TOKEN:
  description: "NetBox API authentication token"
  value: "REPLACE_WITH_YOUR_NETBOX_TOKEN"
  masked: true
  protected: true

# -----------------------------------------------------------------------------
# Optional tuning
# -----------------------------------------------------------------------------

IDRAC_LOG_LEVEL:
  description: "Logging level: debug, info, warn, error"
  value: "info"
  masked: false
  protected: false

IDRAC_CONCURRENCY:
  description: "Maximum number of parallel iDRAC scans"
  value: "10"
  masked: false
  protected: false

IDRAC_DEFAULT_TIMEOUT:
  description: "Per-host connection timeout in seconds"
  value: "60"
  masked: false
  protected: false

# =============================================================================
# Quick-start: common pipeline invocations
# =============================================================================
#
# Fast scan (no tests, store results in repo, skip NetBox):
#   RUN_TESTS=false  SYNC_NETBOX=false
#
# Full run (tests + store in repo, skip NetBox):
#   RUN_TESTS=true   SYNC_NETBOX=false
#
# Full run + NetBox push:
#   RUN_TESTS=true   SYNC_NETBOX=true
#
# In all cases the scan-and-store job is MANUAL — go to the pipeline view
# in GitLab and click the ▶ Play button to trigger it.
#
# =============================================================================
# One-time setup: allow CI to push back to this repo
# =============================================================================
#
# The scan-and-store job commits inventory files and pushes them to this repo
# using CI_JOB_TOKEN.  Enable that in:
#   Settings → CI/CD → Token Access → "Allow CI Job Token to push to this project"
#
# On self-hosted GitLab instances this is often already permitted by default.
# =============================================================================
